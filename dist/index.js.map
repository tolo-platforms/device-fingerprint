{"version":3,"sources":["../src/hash.ts","../src/collectors/screen.ts","../src/collectors/platform.ts","../src/collectors/locale.ts","../src/collectors/canvas.ts","../src/collectors/webgl.ts","../src/collectors/audio.ts","../src/collectors/fonts.ts","../src/collectors/storage.ts","../src/fingerprint.ts"],"names":["hash","str","h1","h2","i","ch","sha256","data","hashBuffer","b","collectScreenSignals","collectPlatformSignals","nav","getPlugins","getMimeTypes","plugins","plugin","types","type","collectLocaleSignals","collectCanvasFingerprint","canvas","ctx","gradient","imageData","collectWebGLSignals","gl","webgl","debugInfo","collectAudioFingerprint","timeout","AudioContext","context","oscillator","analyser","gain","compressor","resolve","frequencyData","dataString","collectFontsFingerprint","testFonts","baseFonts","testString","testSize","baseWidths","baseFont","detectedFonts","font","detected","collectStorageSignals","hasSessionStorage","hasLocalStorage","hasIndexedDB","key","VERSION","defaultOptions","getFingerprint","options","opts","screenSignals","platformSignals","localeSignals","storageSignals","webglSignals","audio","fonts","signals","stableSignals","deviceId","confidence","getDeviceId"],"mappings":"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","file":"index.js","sourcesContent":["/**\n * Simple hash function for fingerprint generation\n * Uses MurmurHash3-like algorithm for speed and good distribution\n */\nexport function hash(str: string): string {\n  let h1 = 0xdeadbeef;\n  let h2 = 0x41c6ce57;\n\n  for (let i = 0; i < str.length; i++) {\n    const ch = str.charCodeAt(i);\n    h1 = Math.imul(h1 ^ ch, 2654435761);\n    h2 = Math.imul(h2 ^ ch, 1597334677);\n  }\n\n  h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507);\n  h1 ^= Math.imul(h2 ^ (h2 >>> 13), 3266489909);\n  h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507);\n  h2 ^= Math.imul(h1 ^ (h1 >>> 13), 3266489909);\n\n  const result = 4294967296 * (2097151 & h2) + (h1 >>> 0);\n  return result.toString(36);\n}\n\n/**\n * SHA-256 hash using Web Crypto API (async, more secure)\n */\nexport async function sha256(str: string): Promise<string> {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(str);\n  const hashBuffer = await crypto.subtle.digest(\"SHA-256\", data);\n  const hashArray = Array.from(new Uint8Array(hashBuffer));\n  return hashArray.map((b) => b.toString(16).padStart(2, \"0\")).join(\"\");\n}\n","/**\n * Collect screen and display signals\n */\nexport function collectScreenSignals() {\n  return {\n    screenResolution: `${screen.width}x${screen.height}`,\n    colorDepth: screen.colorDepth,\n    pixelRatio: window.devicePixelRatio || 1,\n  };\n}\n","/**\n * Collect platform and browser signals\n */\nexport function collectPlatformSignals() {\n  const nav = navigator;\n\n  return {\n    platform: nav.platform || \"unknown\",\n    userAgent: nav.userAgent,\n    vendor: nav.vendor || \"\",\n    hardwareConcurrency: nav.hardwareConcurrency || 0,\n    deviceMemory: (nav as Navigator & { deviceMemory?: number }).deviceMemory ?? null,\n    maxTouchPoints: nav.maxTouchPoints || 0,\n    cookiesEnabled: nav.cookieEnabled,\n    doNotTrack: nav.doNotTrack || null,\n    plugins: getPlugins(),\n    mimeTypes: getMimeTypes(),\n  };\n}\n\nfunction getPlugins(): string[] {\n  const plugins: string[] = [];\n  if (navigator.plugins) {\n    for (let i = 0; i < navigator.plugins.length; i++) {\n      const plugin = navigator.plugins[i];\n      if (plugin) {\n        plugins.push(plugin.name);\n      }\n    }\n  }\n  return plugins;\n}\n\nfunction getMimeTypes(): string[] {\n  const types: string[] = [];\n  if (navigator.mimeTypes) {\n    for (let i = 0; i < navigator.mimeTypes.length; i++) {\n      const type = navigator.mimeTypes[i];\n      if (type) {\n        types.push(type.type);\n      }\n    }\n  }\n  return types;\n}\n","/**\n * Collect timezone and locale signals\n */\nexport function collectLocaleSignals() {\n  return {\n    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || \"unknown\",\n    timezoneOffset: new Date().getTimezoneOffset(),\n    language: navigator.language || \"unknown\",\n    languages: Array.from(navigator.languages || [navigator.language]),\n  };\n}\n","import { hash } from \"../hash\";\n\n/**\n * Generate a canvas fingerprint\n * Draws text and shapes, then hashes the resulting image data\n */\nexport function collectCanvasFingerprint(): string | null {\n  try {\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return null;\n\n    canvas.width = 200;\n    canvas.height = 50;\n\n    // Background\n    ctx.fillStyle = \"#f0f0f0\";\n    ctx.fillRect(0, 0, canvas.width, canvas.height);\n\n    // Text with various styles\n    ctx.textBaseline = \"alphabetic\";\n    ctx.fillStyle = \"#069\";\n    ctx.font = \"14px 'Arial'\";\n    ctx.fillText(\"Tolo Fingerprint ðŸ”\", 2, 15);\n\n    ctx.fillStyle = \"rgba(102, 204, 0, 0.7)\";\n    ctx.font = \"18px 'Times New Roman'\";\n    ctx.fillText(\"Canvas Test\", 4, 35);\n\n    // Geometric shapes\n    ctx.beginPath();\n    ctx.arc(50, 25, 10, 0, Math.PI * 2, true);\n    ctx.closePath();\n    ctx.fillStyle = \"rgba(255, 0, 0, 0.5)\";\n    ctx.fill();\n\n    // Gradient\n    const gradient = ctx.createLinearGradient(100, 0, 200, 0);\n    gradient.addColorStop(0, \"blue\");\n    gradient.addColorStop(1, \"green\");\n    ctx.fillStyle = gradient;\n    ctx.fillRect(100, 10, 75, 30);\n\n    // Get image data and hash it\n    const imageData = canvas.toDataURL(\"image/png\");\n    return hash(imageData);\n  } catch {\n    return null;\n  }\n}\n","/**\n * Collect WebGL fingerprint signals\n */\nexport function collectWebGLSignals(): { vendor: string | null; renderer: string | null } {\n  try {\n    const canvas = document.createElement(\"canvas\");\n    const gl = canvas.getContext(\"webgl\") || canvas.getContext(\"experimental-webgl\");\n\n    if (!gl) {\n      return { vendor: null, renderer: null };\n    }\n\n    const webgl = gl as WebGLRenderingContext;\n    const debugInfo = webgl.getExtension(\"WEBGL_debug_renderer_info\");\n\n    if (!debugInfo) {\n      return {\n        vendor: webgl.getParameter(webgl.VENDOR),\n        renderer: webgl.getParameter(webgl.RENDERER),\n      };\n    }\n\n    return {\n      vendor: webgl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),\n      renderer: webgl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL),\n    };\n  } catch {\n    return { vendor: null, renderer: null };\n  }\n}\n","import { hash } from \"../hash\";\n\n/**\n * Generate an audio fingerprint using AudioContext\n * Different devices produce slightly different audio processing results\n */\nexport async function collectAudioFingerprint(timeout: number = 1000): Promise<string | null> {\n  try {\n    const AudioContext = window.AudioContext || (window as Window & { webkitAudioContext?: typeof window.AudioContext }).webkitAudioContext;\n    if (!AudioContext) return null;\n\n    const context = new AudioContext();\n    const oscillator = context.createOscillator();\n    const analyser = context.createAnalyser();\n    const gain = context.createGain();\n    const compressor = context.createDynamicsCompressor();\n\n    // Configure nodes\n    oscillator.type = \"triangle\";\n    oscillator.frequency.setValueAtTime(10000, context.currentTime);\n\n    compressor.threshold.setValueAtTime(-50, context.currentTime);\n    compressor.knee.setValueAtTime(40, context.currentTime);\n    compressor.ratio.setValueAtTime(12, context.currentTime);\n    compressor.attack.setValueAtTime(0, context.currentTime);\n    compressor.release.setValueAtTime(0.25, context.currentTime);\n\n    gain.gain.setValueAtTime(0, context.currentTime); // Mute output\n\n    // Connect: oscillator -> compressor -> analyser -> gain -> destination\n    oscillator.connect(compressor);\n    compressor.connect(analyser);\n    analyser.connect(gain);\n    gain.connect(context.destination);\n\n    oscillator.start(0);\n\n    // Wait for audio to process\n    await new Promise((resolve) => setTimeout(resolve, Math.min(timeout, 500)));\n\n    const frequencyData = new Float32Array(analyser.frequencyBinCount);\n    analyser.getFloatFrequencyData(frequencyData);\n\n    oscillator.stop();\n    await context.close();\n\n    // Hash the frequency data\n    const dataString = frequencyData.slice(0, 30).join(\",\");\n    return hash(dataString);\n  } catch {\n    return null;\n  }\n}\n","import { hash } from \"../hash\";\n\n/**\n * Detect installed fonts by measuring text rendering differences\n */\nexport function collectFontsFingerprint(): string | null {\n  try {\n    // Common fonts to test for\n    const testFonts = [\n      \"Arial\",\n      \"Arial Black\",\n      \"Comic Sans MS\",\n      \"Courier New\",\n      \"Georgia\",\n      \"Impact\",\n      \"Times New Roman\",\n      \"Trebuchet MS\",\n      \"Verdana\",\n      \"Helvetica\",\n      \"Monaco\",\n      \"Menlo\",\n      \"Consolas\",\n      \"Lucida Console\",\n      \"Tahoma\",\n      \"Palatino\",\n      \"Century Gothic\",\n      \"Bookman Old Style\",\n      \"Garamond\",\n      \"MS Gothic\",\n      \"MS PGothic\",\n      \"MS Mincho\",\n    ];\n\n    const baseFonts = [\"monospace\", \"sans-serif\", \"serif\"];\n    const testString = \"mmmmmmmmmmlli\";\n    const testSize = \"72px\";\n\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) return null;\n\n    // Get baseline widths for base fonts\n    const baseWidths: Record<string, number> = {};\n    for (const baseFont of baseFonts) {\n      ctx.font = `${testSize} ${baseFont}`;\n      baseWidths[baseFont] = ctx.measureText(testString).width;\n    }\n\n    // Test each font\n    const detectedFonts: string[] = [];\n    for (const font of testFonts) {\n      let detected = false;\n      for (const baseFont of baseFonts) {\n        ctx.font = `${testSize} '${font}', ${baseFont}`;\n        const width = ctx.measureText(testString).width;\n        if (width !== baseWidths[baseFont]) {\n          detected = true;\n          break;\n        }\n      }\n      if (detected) {\n        detectedFonts.push(font);\n      }\n    }\n\n    return hash(detectedFonts.join(\",\"));\n  } catch {\n    return null;\n  }\n}\n","/**\n * Detect available storage APIs\n */\nexport function collectStorageSignals() {\n  return {\n    sessionStorage: hasSessionStorage(),\n    localStorage: hasLocalStorage(),\n    indexedDB: hasIndexedDB(),\n  };\n}\n\nfunction hasSessionStorage(): boolean {\n  try {\n    const key = \"__tolo_test__\";\n    sessionStorage.setItem(key, key);\n    sessionStorage.removeItem(key);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nfunction hasLocalStorage(): boolean {\n  try {\n    const key = \"__tolo_test__\";\n    localStorage.setItem(key, key);\n    localStorage.removeItem(key);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nfunction hasIndexedDB(): boolean {\n  try {\n    return !!window.indexedDB;\n  } catch {\n    return false;\n  }\n}\n","import type { DeviceFingerprint, DeviceSignals, FingerprintOptions } from \"./types\";\nimport { sha256 } from \"./hash\";\nimport {\n  collectScreenSignals,\n  collectPlatformSignals,\n  collectLocaleSignals,\n  collectCanvasFingerprint,\n  collectWebGLSignals,\n  collectAudioFingerprint,\n  collectFontsFingerprint,\n  collectStorageSignals,\n} from \"./collectors\";\n\nconst VERSION = \"1.0.0\";\n\n/**\n * Default fingerprint options\n */\nconst defaultOptions: Required<FingerprintOptions> = {\n  canvas: true,\n  webgl: true,\n  audio: true,\n  fonts: true,\n  timeout: 1000,\n};\n\n/**\n * Generate a device fingerprint\n */\nexport async function getFingerprint(\n  options: FingerprintOptions = {}\n): Promise<DeviceFingerprint> {\n  const opts = { ...defaultOptions, ...options };\n\n  // Collect all signals\n  const screenSignals = collectScreenSignals();\n  const platformSignals = collectPlatformSignals();\n  const localeSignals = collectLocaleSignals();\n  const storageSignals = collectStorageSignals();\n  const webglSignals = opts.webgl ? collectWebGLSignals() : { vendor: null, renderer: null };\n\n  // Async collectors\n  const [canvas, audio, fonts] = await Promise.all([\n    opts.canvas ? Promise.resolve(collectCanvasFingerprint()) : Promise.resolve(null),\n    opts.audio ? collectAudioFingerprint(opts.timeout) : Promise.resolve(null),\n    opts.fonts ? Promise.resolve(collectFontsFingerprint()) : Promise.resolve(null),\n  ]);\n\n  const signals: DeviceSignals = {\n    ...screenSignals,\n    ...localeSignals,\n    ...platformSignals,\n    ...storageSignals,\n    canvas,\n    webglVendor: webglSignals.vendor,\n    webglRenderer: webglSignals.renderer,\n    audioFingerprint: audio,\n    fontsHash: fonts,\n  };\n\n  // Generate stable device ID from key signals\n  const stableSignals = [\n    signals.screenResolution,\n    signals.colorDepth,\n    signals.pixelRatio,\n    signals.timezone,\n    signals.platform,\n    signals.hardwareConcurrency,\n    signals.deviceMemory,\n    signals.canvas,\n    signals.webglVendor,\n    signals.webglRenderer,\n    signals.audioFingerprint,\n    signals.fontsHash,\n  ]\n    .filter(Boolean)\n    .join(\"|\");\n\n  const deviceId = await sha256(stableSignals);\n\n  // Calculate confidence based on how many signals we collected\n  const totalSignals = 12;\n  const collectedSignals = [\n    signals.canvas,\n    signals.webglVendor,\n    signals.webglRenderer,\n    signals.audioFingerprint,\n    signals.fontsHash,\n    signals.screenResolution,\n    signals.colorDepth,\n    signals.platform,\n    signals.hardwareConcurrency,\n    signals.timezone,\n    signals.language,\n    signals.userAgent,\n  ].filter(Boolean).length;\n\n  const confidence = collectedSignals / totalSignals;\n\n  return {\n    deviceId,\n    confidence,\n    signals,\n    timestamp: Date.now(),\n    version: VERSION,\n  };\n}\n\n/**\n * Get a simple device ID (just the hash, no signals)\n */\nexport async function getDeviceId(options: FingerprintOptions = {}): Promise<string> {\n  const fingerprint = await getFingerprint(options);\n  return fingerprint.deviceId;\n}\n"]}